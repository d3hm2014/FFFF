<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>فيصل للدعاية والإعلان | Corporate + Showcase</title>
<meta name="description" content="فيصل للدعاية والإعلان — موقع احترافي بوضعين: Corporate الرسمي (افتراضي) و Showcase ثلاثي الأبعاد للعرض." />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020611; --bg2:#050A18;
  --txt:#F3F6FF; --mut:rgba(243,246,255,.74);
  --blue:#2F80ED; --cyan:#56CCF2; --teal:#35F0C2;
  --line:rgba(243,246,255,.10);
  --card:rgba(255,255,255,.04);
  --shadow:0 18px 60px rgba(0,0,0,.55);
  --shadow2:0 12px 28px rgba(0,0,0,.28);
  --max:1200px;
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}
body{
  margin:0;
  font-family:"Cairo",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--txt);
  background:
    radial-gradient(900px 600px at 75% 0%, rgba(86,204,242,.16), transparent 60%),
    radial-gradient(850px 550px at 15% 10%, rgba(47,128,237,.14), transparent 60%),
    linear-gradient(180deg,var(--bg),var(--bg2));
}

/* ===== Layout wrappers ===== */
.container{max-width:var(--max);margin:auto;padding:0 18px}
a{color:inherit;text-decoration:none}

/* ===== Header ===== */
header{
  position:sticky; top:0; z-index:50;
  backdrop-filter: blur(12px);
  background: rgba(2,6,17,.62);
  border-bottom:1px solid var(--line);
}
.hbar{
  display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
  padding:14px 0;
  flex-wrap:wrap;
}
.brand{display:flex;align-items:center;gap:12px;min-width:240px}
.mark{
  width:42px;height:42px;border-radius:16px;
  background:linear-gradient(135deg,var(--blue),var(--cyan));
  box-shadow:var(--shadow2);
  flex:0 0 auto;
}
.brand b{display:block;font-weight:950}
.brand small{display:block;color:var(--mut);font-weight:850;margin-top:2px}

.controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;align-items:center;margin-inline-start:auto}
.btn{
  border:0; cursor:pointer; font-family:inherit;
  padding:10px 14px;border-radius:16px;font-weight:950;
  background:linear-gradient(135deg,var(--blue),var(--cyan));
  color:#041022; white-space:nowrap;
  box-shadow:0 14px 35px rgba(47,128,237,.18);
}
.btn.ghost{
  background:transparent;color:var(--txt);
  border:1px solid rgba(86,204,242,.35);
  box-shadow:none;
}
.mode{
  display:flex; gap:6px; align-items:center;
  border:1px solid rgba(243,246,255,.12);
  background:rgba(255,255,255,.03);
  border-radius:999px;
  padding:6px;
}
.mode button{
  border:0; cursor:pointer; font-family:inherit;
  padding:7px 10px;border-radius:999px;
  background:transparent;color:var(--mut);font-weight:950;
  white-space:nowrap;
}
.mode button.on{
  background:rgba(86,204,242,.16);
  color:var(--txt);
  box-shadow:0 10px 18px rgba(0,0,0,.25);
}

/* ===== Corporate (default) ===== */
#corporate{
  display:block;
}
.hero{
  padding:56px 0 22px;
}
.heroGrid{
  display:grid;
  grid-template-columns: 1.05fr .95fr;
  gap:14px;
  align-items:stretch;
}
.kicker{
  display:inline-flex;align-items:center;gap:10px;
  padding:8px 12px;border-radius:999px;
  border:1px solid rgba(86,204,242,.28);
  background:rgba(86,204,242,.07);
  color:rgba(243,246,255,.82);
  font-weight:950;
  width:fit-content;
}
.kicker .dot{
  width:8px;height:8px;border-radius:50%;
  background:linear-gradient(135deg,var(--blue),var(--cyan));
  box-shadow:0 0 0 6px rgba(86,204,242,.08);
}
.hTitle{margin:14px 0 10px;font-size:2.45rem;line-height:1.12;font-weight:980}
.hSub{margin:0;color:var(--mut);line-height:1.95;font-weight:760;font-size:1.07rem;max-width:64ch}
.cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:16px}
.pills{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
.pill{
  padding:8px 10px;border-radius:999px;
  border:1px solid rgba(243,246,255,.12);
  background:rgba(255,255,255,.03);
  color:var(--mut);font-weight:950;font-size:.92rem;
}
.pill strong{color:var(--txt)}

/* “3D Signature” panel in corporate (lightweight, not WebGL) */
.sig{
  border:1px solid rgba(86,204,242,.22);
  border-radius:28px;
  background:
    radial-gradient(circle at 20% 15%, rgba(86,204,242,.16), transparent 50%),
    radial-gradient(circle at 85% 70%, rgba(47,128,237,.16), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  box-shadow:var(--shadow);
  overflow:hidden;
  padding:14px;
  position:relative;
}
.sigTop{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px}
.sigTop .mini{color:var(--mut);font-weight:950;font-size:.95rem}
.sigStage{
  border-radius:24px;
  border:1px solid rgba(243,246,255,.12);
  background:rgba(0,0,0,.18);
  height:320px;
  position:relative;
  overflow:hidden;
}
.sigStage::before{
  content:"";
  position:absolute; inset:-40%;
  background: conic-gradient(from 160deg, rgba(86,204,242,.18), transparent 35%, rgba(47,128,237,.18), transparent 70%, rgba(53,240,194,.12));
  filter: blur(20px);
  opacity:.75;
}
.gridLines{
  position:absolute; inset:0;
  background:
    linear-gradient(to right, rgba(244,247,255,.06) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(244,247,255,.05) 1px, transparent 1px);
  background-size: 34px 34px;
  mask-image: radial-gradient(circle at 50% 40%, rgba(0,0,0,1), rgba(0,0,0,.25) 60%, transparent 78%);
  opacity:.6;
}
.sigLogo{
  position:absolute; left:50%; top:50%;
  width:min(360px, 86%);
  translate:-50% -50%;
  border-radius:26px;
  border:1px solid rgba(244,247,255,.14);
  background:rgba(255,255,255,.04);
  box-shadow:var(--shadow2);
  overflow:hidden;
  transform-style:preserve-3d;
  will-change:transform;
}
.sigLogo::after{
  content:"";position:absolute; inset:-35%;
  background: linear-gradient(120deg, transparent 42%, rgba(255,255,255,.16), transparent 60%);
  transform: translateX(-18%) rotate(12deg);
  animation: sweep 6.2s ease-in-out infinite;
}
.sigLogo img{
  width:100%; display:block;
  filter: drop-shadow(0 24px 40px rgba(0,0,0,.45));
}
@keyframes sweep{
  0%,100%{opacity:.22; transform: translateX(-18%) rotate(12deg)}
  50%{opacity:.48; transform: translateX(18%) rotate(12deg)}
}
.sigKpis{
  display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px
}
.kpi{
  border:1px solid rgba(243,246,255,.10);
  background:rgba(255,255,255,.03);
  border-radius:18px;padding:12px;
}
.kpi b{display:block;font-weight:980}
.kpi span{display:block;margin-top:4px;color:var(--mut);font-weight:950;font-size:.92rem}

/* Sections */
.section{padding:56px 0}
.section.alt{
  border-top:1px solid var(--line);
  border-bottom:1px solid var(--line);
  background: linear-gradient(180deg, rgba(255,255,255,.025), rgba(255,255,255,.01));
}
.head{margin-bottom:16px}
.head h2{margin:0 0 6px;font-size:1.8rem;font-weight:980}
.head p{margin:0;color:var(--mut);font-weight:780;line-height:1.9}

.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.card{
  border:1px solid rgba(243,246,255,.10);
  background:rgba(255,255,255,.03);
  border-radius:22px;
  padding:16px;
  box-shadow:var(--shadow2);
}
.card h3{margin:0 0 8px;font-weight:980}
.card p{margin:0;color:var(--mut);line-height:1.9;font-weight:760}
.card ul{margin:10px 0 0;padding:0 18px;color:var(--mut);line-height:1.95;font-weight:780}

.steps{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.step{
  display:flex;gap:12px;align-items:flex-start;
  border:1px solid rgba(243,246,255,.10);
  background:rgba(255,255,255,.03);
  border-radius:22px;
  padding:14px;
}
.num{
  width:36px;height:36px;border-radius:16px;
  background:rgba(86,204,242,.09);
  border:1px solid rgba(86,204,242,.22);
  display:flex;align-items:center;justify-content:center;
  font-weight:980;
}
.step b{display:block;font-weight:980;margin-bottom:6px}
.step p{margin:0;color:var(--mut);line-height:1.9;font-weight:780}

.contact{display:grid;grid-template-columns:1fr 1fr;gap:14px;align-items:start}
.box{
  border:1px solid rgba(243,246,255,.10);
  background:rgba(255,255,255,.03);
  border-radius:22px;padding:16px;
}
.kv{display:grid;gap:10px;margin-top:10px}
.item{
  border:1px solid rgba(243,246,255,.10);
  background:rgba(0,0,0,.14);
  border-radius:18px;padding:12px;
}
.label{color:var(--mut);font-weight:950;font-size:.9rem}
.value{display:block;margin-top:6px;font-weight:980}

form{display:grid;gap:10px;margin-top:10px}
label span{display:block;margin-bottom:6px;color:var(--mut);font-weight:950}
input,select,textarea{
  width:100%;
  border:1px solid rgba(243,246,255,.12);
  background:rgba(0,0,0,.18);
  color:var(--txt);
  border-radius:16px;
  padding:12px;
  outline:none;
  font-family:inherit;
  font-weight:780;
}
input:focus,select:focus,textarea:focus{border-color:rgba(86,204,242,.55)}
.note{margin:0;color:var(--mut);font-weight:780;line-height:1.9;font-size:.92rem}

footer{
  border-top:1px solid var(--line);
  background:rgba(0,0,0,.16);
  padding:22px 0;
}
.foot{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.links{display:flex;gap:10px;flex-wrap:wrap}
.links a{color:var(--mut);font-weight:980;padding:8px 10px;border-radius:16px}
.links a:hover{background:rgba(255,255,255,.05);color:var(--txt)}

/* ===== Showcase (WebGL) ===== */
#showcase{
  display:none;
}
#wrap3d{ position:relative; height: 640vh; }
#wrap3d canvas{ position:sticky; top:0; width:100%; height:100vh; display:block; }
.hud3d{ position:sticky; top:0; height:100vh; pointer-events:none; }
.scene{
  position:absolute; right:16px; left:16px; bottom:18px;
  display:grid; gap:10px; max-width:820px;
}
.scene .sCard{
  border:1px solid var(--line);
  background:rgba(255,255,255,.04);
  border-radius:22px;
  padding:16px;
  box-shadow:var(--shadow);
  transform: translateY(14px);
  opacity:0;
  transition: opacity .28s ease, transform .28s ease;
}
.scene .sCard.on{opacity:1; transform:translateY(0)}
.hint{
  position:absolute; left:50%; top:88vh; translate:-50% 0;
  color:rgba(243,246,255,.65); font-weight:900; font-size:.92rem;
  border:1px solid rgba(243,246,255,.10);
  background:rgba(2,6,17,.45);
  padding:10px 12px;border-radius:999px;
  backdrop-filter:blur(10px);
  transition: opacity .25s ease, transform .25s ease;
}
.hint.hide{opacity:0; transform:translateY(10px)}

/* Responsive */
@media (max-width:980px){
  .heroGrid,.grid3,.steps,.contact{grid-template-columns:1fr}
  .sigKpis{grid-template-columns:1fr}
  .brand{min-width:unset; flex:1 1 260px}
  .controls{justify-content:flex-start; width:100%}
  .hTitle{font-size:2.0rem}
  #wrap3d{height: 700vh;}
}
@media (max-width:520px){
  .btn{padding:9px 12px}
  .mode{width:100%; justify-content:space-between}
}
@media (prefers-reduced-motion: reduce){
  .sigLogo::after{animation:none}
}
</style>
</head>

<body>

<header>
  <div class="container hbar">
    <a class="brand" href="#top" aria-label="فيصل للدعاية والإعلان">
      <span class="mark" aria-hidden="true"></span>
      <span>
        <b>فيصل للدعاية والإعلان</b>
        <small>الرياض • نخدم السعودية بالكامل</small>
      </span>
    </a>

    <div class="controls">
      <div class="mode" aria-label="اختيار وضع الموقع">
        <button id="btnCorp" class="on" type="button">Corporate</button>
        <button id="btnShow" type="button">Showcase 3D</button>
      </div>
      <a class="btn ghost" href="#services">الخدمات</a>
      <a class="btn" href="#contact">اطلب عرضًا</a>
    </div>
  </div>
</header>

<!-- ============ CORPORATE (DEFAULT) ============ -->
<main id="corporate">
  <div id="top"></div>

  <section class="hero">
    <div class="container heroGrid">
      <div>
        <div class="kicker"><span class="dot"></span> Corporate Mode (افتراضي)</div>
        <h1 class="hTitle">وكالة اتصالية تعمل<br>بعقلية تشغيل ونتائج</h1>
        <p class="hSub">
          تصميم مؤسسي، تشغيل منضبط، وقياس أثر. هذا الموقع هو النسخة الرسمية السريعة المناسبة للجهات والشركات.
          وتقدر تحول إلى Showcase 3D وقت العرض بضغطة.
        </p>

        <div class="cta">
          <a class="btn" href="#contact">اطلب عرضًا فنيًا</a>
          <button class="btn ghost" type="button" id="jumpToShow">افتح Showcase 3D</button>
        </div>

        <div class="pills">
          <span class="pill"><strong>KPIs</strong> واضحة</span>
          <span class="pill"><strong>SLA</strong> واستجابة</span>
          <span class="pill">حوكمة واعتمادات</span>
          <span class="pill">تقارير دورية</span>
        </div>
      </div>

      <aside class="sig" aria-label="توقيع بصري (بدون WebGL)">
        <div class="sigTop">
          <div class="mini">توقيع بصري — حركة خفيفة “محترمة”</div>
          <div class="mini">Fast / Corporate</div>
        </div>

        <div class="sigStage" id="sigStage">
          <div class="gridLines" aria-hidden="true"></div>
          <div class="sigLogo" id="sigLogo">
            <img src="logo.jpg" alt="شعار فيصل للدعاية والإعلان">
          </div>
        </div>

        <div class="sigKpis">
          <div class="kpi"><b>تشغيل</b><span>تقويم + اعتماد</span></div>
          <div class="kpi"><b>قياس أثر</b><span>Dashboard + تقارير</span></div>
          <div class="kpi"><b>تحسين</b><span>توصيات + A/B</span></div>
        </div>
      </aside>
    </div>
  </section>

  <section id="services" class="section">
    <div class="container">
      <div class="head">
        <h2>الخدمات</h2>
        <p>حزم واضحة تصلح للعروض الفنية: استراتيجية → تشغيل → حملات → قياس.</p>
      </div>

      <div class="grid3">
        <div class="card">
          <h3>استراتيجية واتصال مؤسسي</h3>
          <p>رسائل، نبرة، وخطط اتصالية قابلة للتنفيذ مع إطار قياس واضح.</p>
          <ul><li>خطة سنوية/ربع سنوية</li><li>تعريف KPIs</li><li>خارطة أصحاب المصلحة</li></ul>
        </div>
        <div class="card">
          <h3>إدارة المحتوى والمنصات</h3>
          <p>تقويم + كتابة + تصميم + نشر + إدارة مجتمع وفق اعتماد.</p>
          <ul><li>قوالب مؤسسية</li><li>مراجعة قبل النشر</li><li>سجل تغييرات</li></ul>
        </div>
        <div class="card">
          <h3>حملات رقمية مدفوعة</h3>
          <p>إعلانات بتركيز على “النتيجة” مع تتبع وتحسين مستمر.</p>
          <ul><li>Google / Meta / X / Snap / TikTok</li><li>UTM + Pixels</li><li>تقارير تفصيلية</li></ul>
        </div>
        <div class="card">
          <h3>إنتاج مرئي وإبداع</h3>
          <p>هوية حملة + موشن + فيديوهات قصيرة برسالة واضحة.</p>
          <ul><li>Key Visual</li><li>Shorts / Motion</li><li>مكتبة أصول</li></ul>
        </div>
        <div class="card">
          <h3>مؤثرون وإدارة سمعة</h3>
          <p>اختيار وتقييم وتوثيق، ومراقبة سمعة بخطة.</p>
          <ul><li>تقييم مؤثرين</li><li>إدارة عقود</li><li>Share of Voice</li></ul>
        </div>
        <div class="card">
          <h3>تقارير وقياس أثر</h3>
          <p>لوحات مؤشرات + تقرير أسبوعي تنفيذي + تقرير شهري توصيات.</p>
          <ul><li>Dashboard</li><li>تحليل محتوى</li><li>خطة تحسين</li></ul>
        </div>
      </div>
    </div>
  </section>

  <section id="method" class="section alt">
    <div class="container">
      <div class="head">
        <h2>المنهجية</h2>
        <p>طريقة تشغيل واضحة — مو ارتجال.</p>
      </div>
      <div class="steps">
        <div class="step"><div class="num">1</div><div><b>تحليل وتشخيص</b><p>أهداف، جمهور، قنوات، ومؤشرات نجاح.</p></div></div>
        <div class="step"><div class="num">2</div><div><b>خطة تشغيل</b><p>تقويم + حملات + اعتماد + ميزانيات.</p></div></div>
        <div class="step"><div class="num">3</div><div><b>تنفيذ مضبوط</b><p>إنتاج + نشر + إعلانات + ضبط جودة.</p></div></div>
        <div class="step"><div class="num">4</div><div><b>قياس وتحسين</b><p>KPIs + تقارير + توصيات + A/B.</p></div></div>
      </div>
    </div>
  </section>

  <section id="contact" class="section">
    <div class="container">
      <div class="head">
        <h2>طلب عرض / تواصل</h2>
        <p>بيانات مؤقتة الآن — عدّلها لاحقًا.</p>
      </div>

      <div class="contact">
        <div class="box">
          <b style="font-weight:980">بيانات التواصل</b>
          <div class="kv">
            <div class="item"><span class="label">الهاتف</span><a class="value" href="tel:+966500000000">+966 50 000 0000</a></div>
            <div class="item"><span class="label">البريد</span><a class="value" href="mailto:hello@faisal-ads.sa">hello@faisal-ads.sa</a></div>
            <div class="item"><span class="label">المقر</span><span class="value">الرياض — نخدم السعودية بالكامل</span></div>
          </div>
          <p class="note" style="margin-top:10px">GitHub Pages لا يرسل بريد مباشرة. استخدم Formspree أو Google Forms.</p>
        </div>

        <div class="box">
          <b style="font-weight:980">نموذج الطلب</b>
          <form action="https://formspree.io/f/xxxxxxxx" method="POST">
            <label><span>الاسم</span><input name="name" required placeholder="اسمك الكامل"></label>
            <label><span>الجهة / الشركة</span><input name="company" placeholder="اختياري"></label>
            <label><span>البريد</span><input name="email" type="email" required placeholder="name@company.com"></label>
            <label><span>نوع الخدمة</span>
              <select name="service">
                <option>استراتيجية واتصال مؤسسي</option>
                <option>إدارة محتوى ومنصات</option>
                <option>حملات رقمية مدفوعة</option>
                <option>إنتاج مرئي وإبداع</option>
                <option>تقارير وقياس أثر</option>
                <option>أخرى</option>
              </select>
            </label>
            <label><span>تفاصيل الطلب</span><textarea name="message" rows="5" required placeholder="اكتب المطلوب، المدة، وأي ملاحظات"></textarea></label>
            <button class="btn" type="submit">إرسال</button>
            <p class="note">غيّر xxxxxxxx برابط Formspree الخاص بك.</p>
          </form>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container foot">
      <div>
        <b style="font-weight:980">فيصل للدعاية والإعلان</b>
        <div style="color:var(--mut);font-weight:900">Corporate default • Showcase optional</div>
      </div>
      <div class="links">
        <a href="#services">الخدمات</a>
        <a href="#method">المنهجية</a>
        <a href="#contact">تواصل</a>
      </div>
    </div>
  </footer>
</main>

<!-- ============ SHOWCASE 3D (ON DEMAND) ============ -->
<main id="showcase" aria-hidden="true">
  <div id="wrap3d">
    <canvas id="c3d"></canvas>

    <div class="hud3d">
      <div class="hint" id="hint3d">اسحب للأسفل ⟵ العرض ثلاثي الأبعاد</div>

      <div class="scene" aria-live="polite">
        <div class="sCard" id="sc0">
          <div class="kicker"><span class="dot"></span> Showcase Mode</div>
          <h1 style="margin:10px 0 6px">عرض 3D للـPitch</h1>
          <p style="margin:0;color:var(--mut);line-height:1.95;font-weight:760">
            هذا الوضع للعرض والانطباع. إذا تبغى نسخة رسمية: ارجع Corporate.
          </p>
          <div class="pills" style="margin-top:10px">
            <span class="pill">WOW محسوب</span>
            <span class="pill"><strong>سلاسة</strong> + تخفيف تلقائي</span>
          </div>
        </div>

        <div class="sCard" id="sc1">
          <div class="kicker"><span class="dot"></span> المشهد 1</div>
          <h1 style="margin:10px 0 6px">غرفة عمليات للاتصال</h1>
          <p style="margin:0;color:var(--mut);line-height:1.95;font-weight:760">خطة → تشغيل → قياس أثر.</p>
        </div>

        <div class="sCard" id="sc2">
          <div class="kicker"><span class="dot"></span> المشهد 2</div>
          <h1 style="margin:10px 0 6px">حملات “نتيجة”</h1>
          <p style="margin:0;color:var(--mut);line-height:1.95;font-weight:760">UTM + تتبع + تحسين.</p>
        </div>

        <div class="sCard" id="sc3">
          <div class="kicker"><span class="dot"></span> المشهد 3</div>
          <h1 style="margin:10px 0 6px">حوكمة</h1>
          <p style="margin:0;color:var(--mut);line-height:1.95;font-weight:760">SLA + اعتمادات + سرية.</p>
        </div>
      </div>
    </div>

    <div id="end3d" style="height:100vh;display:flex;align-items:center;padding:24px 16px">
      <div class="container" style="width:100%">
        <div style="border:1px solid var(--line);background:rgba(255,255,255,.04);border-radius:22px;padding:18px;box-shadow:var(--shadow)">
          <h2 style="margin:0 0 6px;font-weight:980">نهاية العرض</h2>
          <p style="margin:0;color:var(--mut);line-height:1.9;font-weight:760">
            ارجع Corporate للاستخدام الرسمي، أو خذ رابط Showcase للعرض.
          </p>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn" type="button" id="backCorp">رجوع Corporate</button>
            <a class="btn ghost" href="mailto:hello@faisal-ads.sa">hello@faisal-ads.sa</a>
          </div>
        </div>
      </div>
    </div>

  </div>
</main>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script>
/* =========================
   Dual Experience Controller
   ========================= */
const corporate = document.getElementById('corporate');
const showcase  = document.getElementById('showcase');
const btnCorp   = document.getElementById('btnCorp');
const btnShow   = document.getElementById('btnShow');
const jumpToShow= document.getElementById('jumpToShow');
const backCorp  = document.getElementById('backCorp');

function openCorporate(){
  corporate.style.display = 'block';
  showcase.style.display  = 'none';
  showcase.setAttribute('aria-hidden','true');
  btnCorp.classList.add('on'); btnShow.classList.remove('on');
  stopShowcase3D();
  window.scrollTo({top:0, behavior:'smooth'});
}
function openShowcase(){
  corporate.style.display = 'none';
  showcase.style.display  = 'block';
  showcase.setAttribute('aria-hidden','false');
  btnShow.classList.add('on'); btnCorp.classList.remove('on');
  window.scrollTo({top:0, behavior:'smooth'});
  startShowcase3D();
}

btnCorp.addEventListener('click', openCorporate);
btnShow.addEventListener('click', openShowcase);
jumpToShow.addEventListener('click', openShowcase);
backCorp.addEventListener('click', openCorporate);

/* ===== Corporate “signature” tilt (lightweight) ===== */
(()=>{
  const stage = document.getElementById('sigStage');
  const logo  = document.getElementById('sigLogo');
  if(!stage || !logo) return;
  const isTouch = matchMedia('(pointer: coarse)').matches;
  const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
  if(isTouch || reduce) return;

  const clamp=(n,min,max)=>Math.max(min,Math.min(max,n));
  stage.addEventListener('mousemove',(e)=>{
    const r=stage.getBoundingClientRect();
    const x=(e.clientX-r.left)/r.width-0.5;
    const y=(e.clientY-r.top)/r.height-0.5;
    const ry=clamp(x*10,-7,7);
    const rx=clamp(-y*10,-7,7);
    logo.style.transform = `translate(-50%,-50%) rotateX(${rx}deg) rotateY(${ry}deg)`;
    logo.style.position = 'absolute';
    logo.style.left='50%'; logo.style.top='50%';
  });
  stage.addEventListener('mouseleave',()=>{ logo.style.transform='translate(-50%,-50%)'; });
})();

/* =========================
   SHOWCASE 3D (On-demand)
   - Scroll smoothing
   - Auto degrade on low FPS
   - Less objects on mobile
   ========================= */
let rafId = null;
let renderer=null, scene=null, camera=null, ring=null, disc=null, badge=null, cubes=[];
let running=false;

function startShowcase3D(){
  if(running) return;
  running = true;

  const canvas = document.getElementById('c3d');
  const wrap = document.getElementById('wrap3d');
  const hint = document.getElementById('hint3d');

  scene = new THREE.Scene();
  renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
  renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
  renderer.setSize(innerWidth, innerHeight);

  camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 140);
  camera.position.set(0, 0.15, 7.3);

  const key = new THREE.DirectionalLight(0x56ccf2, 1.25); key.position.set(3.2,4.2,2.5); scene.add(key);
  const fill= new THREE.DirectionalLight(0x2f80ed, 1.00); fill.position.set(-3.5,2.2,3.0); scene.add(fill);
  const rim = new THREE.DirectionalLight(0x35f0c2, 0.55); rim.position.set(0,3,-3); scene.add(rim);
  scene.add(new THREE.AmbientLight(0xffffff, 0.30));

  const ringGeo = new THREE.TorusGeometry(1.58, 0.20, 36, 240);
  const ringMat = new THREE.MeshStandardMaterial({
    color:0x2f80ed, metalness:0.62, roughness:0.22,
    emissive:0x061a3a, emissiveIntensity:1.05
  });
  ring = new THREE.Mesh(ringGeo, ringMat);
  scene.add(ring);

  const discGeo = new THREE.CircleGeometry(1.14, 72);
  const discMat = new THREE.MeshPhysicalMaterial({
    color:0x56ccf2, transparent:true, opacity:0.12,
    roughness:0.08, metalness:0.0, transmission:0.95, thickness:0.8,
    clearcoat:1, clearcoatRoughness:0.10
  });
  disc = new THREE.Mesh(discGeo, discMat);
  disc.position.z = -0.08;
  scene.add(disc);

  // Logo texture badge
  const loader = new THREE.TextureLoader();
  loader.load("logo.jpg",(tex)=>{
    tex.colorSpace = THREE.SRGBColorSpace;
    tex.anisotropy = Math.min(8, renderer.capabilities.getMaxAnisotropy());
    const g = new THREE.CircleGeometry(0.76, 72);
    const m = new THREE.MeshPhysicalMaterial({
      map:tex, roughness:0.14, metalness:0.05,
      transmission:0.55, thickness:0.6, clearcoat:1, clearcoatRoughness:0.06
    });
    badge = new THREE.Mesh(g,m);
    badge.position.z = 0.30;
    scene.add(badge);
  });

  // Cubes: fewer on mobile, and auto-degrade later
  const isTouch = matchMedia('(pointer: coarse)').matches;
  const reduce  = matchMedia('(prefers-reduced-motion: reduce)').matches;
  let cubeCount = (isTouch || reduce) ? 10 : 18;

  const cubeMat = new THREE.MeshStandardMaterial({ color:0x35f0c2, metalness:.22, roughness:.36 });
  cubes = [];
  for(let i=0;i<cubeCount;i++){
    const g = new THREE.BoxGeometry(0.12,0.12,0.12);
    const c = new THREE.Mesh(g,cubeMat);
    c.position.set((Math.random()-0.5)*4.6,(Math.random()-0.5)*2.7,(Math.random()-0.5)*2.5);
    c.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,0);
    scene.add(c);
    cubes.push(c);
  }

  // Scene cards
  const sCards = [sc0,sc1,sc2,sc3];
  function setScene(t){
    const idx = Math.min(3, Math.max(0, Math.floor(t*4)));
    sCards.forEach((c,i)=>c.classList.toggle('on', i===idx));
  }

  // Smooth scroll
  const rawT = ()=>{
    const max = wrap.scrollHeight - innerHeight;
    return max>0 ? scrollY/max : 0;
  };
  let tNow=0, tTarget=0;
  const damp=0.08;
  const lerp=(a,b,t)=>a+(b-a)*t;

  // FPS monitor auto-degrade
  let last = performance.now();
  let badFrames = 0;
  let degraded = false;

  const clock = new THREE.Clock();
  function frame(){
    if(!running) return;

    tTarget = rawT();
    tNow = lerp(tNow, tTarget, damp);
    setScene(tNow);
    if(tTarget > 0.02) hint.classList.add('hide'); else hint.classList.remove('hide');

    const time = clock.getElapsedTime();

    ring.rotation.y = tNow*Math.PI*2.45 + Math.sin(time*0.15)*0.06;
    ring.rotation.x = 0.32 + Math.sin(tNow*Math.PI)*0.22;
    ring.scale.setScalar(1 + Math.sin(tNow*Math.PI)*0.18);

    disc.rotation.z = tNow*Math.PI*1.75;

    if(badge){
      badge.rotation.z = -tNow*Math.PI*0.7;
      badge.position.y = Math.sin(time*0.85)*0.025;
    }

    camera.position.z = 7.3 - tNow*3.05;
    camera.position.y = 0.15 + Math.sin(tNow*Math.PI)*0.20;
    camera.lookAt(0,0,0);

    const speed = degraded ? 0.65 : 1.0;
    cubes.forEach((m,i)=>{
      m.rotation.x += (0.0048 + i*0.00002) * speed;
      m.rotation.y += (0.0052 + i*0.00002) * speed;
      m.position.y += Math.sin(time*0.85 + i)*0.00065 * speed;
    });

    renderer.render(scene, camera);

    // FPS check
    const now = performance.now();
    const dt = now - last; last = now;
    if(dt > 34) badFrames++; else badFrames = Math.max(0, badFrames-1);

    // If sustained lag, degrade once
    if(!degraded && badFrames > 18){
      degraded = true;
      // remove half cubes for performance
      for(let i=cubes.length-1;i>=0;i-=2){
        scene.remove(cubes[i]);
        cubes.splice(i,1);
      }
      // lower pixel ratio slightly
      renderer.setPixelRatio(Math.min(devicePixelRatio, 1.3));
    }

    rafId = requestAnimationFrame(frame);
  }

  frame();

  // Resize
  window.__showResize = ()=>{
    if(!running) return;
    renderer.setSize(innerWidth, innerHeight);
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
  };
  window.addEventListener('resize', window.__showResize);
}

function stopShowcase3D(){
  if(!running) return;
  running=false;

  if(rafId) cancelAnimationFrame(rafId);
  rafId=null;

  if(window.__showResize){
    window.removeEventListener('resize', window.__showResize);
    window.__showResize = null;
  }

  // Dispose (lightweight cleanup)
  try{
    if(renderer){
      renderer.dispose();
    }
  }catch(e){}

  renderer=null; scene=null; camera=null; ring=null; disc=null; badge=null; cubes=[];
}

/* Start in corporate */
openCorporate();
</script>

</body>
</html>
